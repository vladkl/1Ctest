<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="__STYLE__"></link><meta name="GENERATOR" content="MSHTML 11.00.9600.18792"></meta></head><body>
<h1>Технологический журнал</h1>
<dl><dt>Содержание 
</dt><dd><a href="#tl_internals">Принцип работы</a> 
<dd><a href="#setup">Настройка</a> 
<dl><dd><a href="#tl_logcfg_dir">Каталог настройки ТЖ</a> 
<dd><a href="#tl_network_dir">Сетевой каталог ТЖ</a> 
<dd><a href="#tl_local_dir">Локальный каталог ТЖ</a></dd></dd></dd></dl></dd></dd></dl><h2 id="tl_internals">Принцип работы</h2>
<p>Следующим пользователям необходимо установить соответствующие права на локальные и сетевые каталоги настройки и сбора технологического журнала:</p>
<ul><li>пользователи, от имени которых запускаются рабочие процессы ЦУП; 
</li><li>пользователи, от имени которых запускаются рабочие процессы исследуемой информационной базы.</li></ul><p>Принципиальная схема обращения ЦУП к каталогам технологического журнала исследуемой информационной базы выглядит так:</p>
<p><img src="_files/TLAccessSchema2.png" width="558" height="366"></img></p>
<p></p>
<p></p>
<p>При включении записи аналитических показателей, сервер ЦУП настраивает файлы logcfg.xml для каждого рабочего сервера исследуемой информационной базы. Для этого у рабочих процессов кластера ЦУП должны быть права записи (зеленый замок) в каталог файла настройки технологического журнала logcfg.xml. Рабочие процессы исследуемой информационной базы перечитывают настройки logcfg.xml и в течении минуты включают запись технологического журнала в указанные каталоги. При этом у рабочих процессов должны быть права записи (красный замок) в указанные в настройках ЦУП каталоги.</p>
<p>При выключении записи аналитических показателей, сервер ЦУП удаляет сделанные им ранее настройки из logcfg.xml. Рабочие процессы исследуемой информационной базы в очередной раз перечитывают logcfg.xml и в течении минуты отключают запись в каталоги технологического журнала.</p>
<p>После остановки записи в технологический журнал исследуемой информационной базы, фоновые задания информационной базы ЦУП, работающие в рабочих процессах кластера информационной базы ЦУП, загружают созданный технологический журнал в информационную базу ЦУП и удаляют файлы технологического журнала. Для возможности чтения и удаления файлов и каталогов технологического журнала, у рабочих процессов ЦУП должны быть права чтения и записи (красный замок) в каталоги технологического журнала.</p>
<p>Доступ к каталогам настройки и сбора технологического журнала может осуществляться по сетевым путям, поэтому важно понимать, как настраиваются права доступа в данном случае. Ниже рассмотрен случай, когда на рабочем сервере исследуемой информационной базы расположены рабочие процессы и каталоги технологического журнала, к которым обращается ЦУП.</p>
<p><img src="_files/NetFolderAccess2.png"></img></p>
<p>Рабочие процессы исследуемой информационной базы обращаются к локальному каталогу технологического журнала, поэтому у них должен быть соответствующий доступ к нему (зеленый замок).</p>
<p>Сетевой каталог можно рассматривать, как ссылку на локальный каталог, но при этом права доступа к сетевому каталогу настраиваются отдельно (красный замок). В результате, права доступа к сетевому ресурсу, это результат пересечения множества прав на локальный (зеленый замок) и сетевой каталоги (красный замок).</p>
<p>ВНИМАНИЕ: Для того, чтобы пользователь смог получить доступ к содержимому сетевого каталога, у него должны быть соответствующие права доступа сразу в локальный (зеленый замок) и сетевой каталог (красный замок). Следовательно, если у пользователя, обращающегося к сетевому ресурсу, не будет доступа к локальному или сетевому ресурсу, то в доступе будет отказано.</p>
<h2 id="setup">Настройка</h2>
<p>Для каждого рабочего сервера кластера исследуемой информационной базы необходимо добавить по одной строке настроек технологического журнала, о каждой из которых рассказывается далее. </p>
<p>Пример настроек, где:</p>
<ul><li><strong>Server1C</strong> - имя сервера на котором запущены рабочие процессы сервера 1С:Предприятия исследуемой информационной базы; 
</li><li><strong>сonf</strong> - имя сетевого ресурса, ссылающегося на подкаталог "conf", каталога запуска сервера 1С:Предприятия исследуемой информационной базы; 
</li><li><strong>Logs</strong> - каталог, куда сервер 1С:Предприятия исследуемой информационной базы будет записывать файлы технологического журнала.</li></ul><p><img src="_files/TL11.png"></img></p>
<h3 id="tl_logcfg_dir">Каталог настроек ТЖ </h3>
<p>Каталог настроек технологического журнала исследуемой информационной базы расположен в подкаталоге "conf", каталога запуска сервера 1С:Предприятия исследуемой информационной базы. Например, если сервер исследуемой информационной базы находится на компьютере под управлением операционной системы Microsoft Windows, этот каталог, при установке 1С:Предприятия по-умолчанию, будет иметь имя:</p>
<ul><li>
<div>"%PROGRAMFILES%\1cv8\8.3.x.y\bin\conf" (C:\Program Files\1cv8\8.3.10.2302\bin\conf).</div></li></ul><p>Если сервер ЦУП и сервер 1С:Предприятия исследуемой информационной базы находятся на одном компьютере, то в качестве имени каталога настройки ТЖ можно использовать локальное имя каталога ТЖ (по-умолчанию: %PROGRAMFILES%\1cv8\8.3.x.y\bin\conf).</p>
<p>Если сервер ЦУП и сервер 1С:Предприятия исследуемой информационной базы находятся на разных компьютерах, то необходимо, для каталога настройки ТЖ, <a href="Catalog.ИнформационныеБазы.Template.СетевыеКаталоги/Template">создать сетевой ресурс</a>, чтобы он был доступен по сети. Затем имя полученного сетевого ресурса нужно указать в качестве имени каталога настройки ТЖ.</p>
<p>В результате получится сетевой ресурс вида "\\Server1C\conf" (где: Server1C - имя сервера исследуемой ИБ; conf - имя созданного ранее сетевого ресурса), который необходимо указать в качестве каталога настройки ТЖ.</p>
<p>У пользователя, от имени которого запущены рабочие процессы кластера исследуемой информационной базы, должны быть настроены права на чтение и запись в указанном каталоге настройки ТЖ, как локально, так и по сети. Локальные права настраиваются в свойствах каталога на закладке "Security" (безопасность). Сетевые права настраиваются в свойствах каталога на закладке "Sharing" (доступ).</p>
<table class="remark" style="WIDTH: 100%" cellspacing="0" cellpadding="0"><tbody><tr><td> </td>
<td>Рабочие процессы исследуемой ИБ</td></tr><tr><td>Право чтения</td>
<td>√</td></tr><tr><td>Право записи</td>
<td>√</td></tr></tbody></table><p>ВНИМАНИЕ: Для работы ЦУП, файл logcfg.xml создавать вручную не нужно, т.к. всю необходимую работу по настройке технологического журнала, ЦУП выполнит самостоятельно.</p>
<h3 id="tl_network_dir">Сетевой каталог сбора данных ТЖ</h3>
<p>Сетевой каталог ТЖ ссылается на <a href="#tl_local_dir">локальный каталог сбора данных ТЖ</a>, т.е. сетевой и локальный каталоги ТЖ указывают на одно и тоже место, но различными способами.</p>
<p>Если сервер ЦУП и сервер 1С:Предприятия исследуемой информационной базы находятся на одном компьютере, то в качестве имени сетевого каталога ТЖ можно использовать локальное имя каталога ТЖ (частный случай).</p>
<p>Если сервер ЦУП и сервер 1С:Предприятия исследуемой информационной базы находятся на разных компьютерах, то необходимо для <a href="#tl_local_dir">локального каталога ТЖ</a>, создать <a href="Catalog.ИнформационныеБазы.Template.СетевыеКаталоги/Template">сетевой ресурс</a>, который и станет сетевым каталогом ТЖ. Затем имя полученного сетевого ресурса нужно указать в качестве имени сетевого каталога ТЖ. </p>
<p>В результате получится сетевой ресурс вида <a href="file://\\Server1C\Logs">\\Server1C\Logs</a> (где: Server1C - имя сервера исследуемой ИБ; Logs - имя созданного ранее сетевого ресурса), который необходимо указать в качестве каталога настройки ТЖ.</p>
<p>У пользователей, от имени которых запущены рабочие процессы кластера информационной базы ЦУП, должны быть права чтения и записи в сетевой каталог ТЖ, как локально, так и по сети. Локальные права настраиваются в свойствах каталога на закладке "Security" (безопасность). Сетевые права настраиваются в свойствах каталога на закладке "Sharing" (доступ).</p>
<table class="remark" style="WIDTH: 100%" cellspacing="0" cellpadding="0"><tbody><tr><td> </td>
<td>Рабочие процессы ЦУП</td></tr><tr><td>Право чтения</td>
<td>√</td></tr><tr><td>Право записи</td>
<td>√</td></tr></tbody></table><h3 id="tl_local_dir">Локальный каталог сбора данных ТЖ</h3>
<p>Локальный каталог ТЖ может располагаться в любом каталоге на компьютере сервера 1С:Предприятия исследуемой информационной базы. Этот каталог является основой для создания <a href="#tl_network_dir">сетевого каталога ТЖ</a>. </p>
<p>У пользователей, от имени которых запущены рабочие процессы кластеров, как исследуемой информационной базы, так и информационной базы ЦУП, должны быть права чтения и записи в этот каталог.</p>
<table class="remark" style="WIDTH: 100%" cellspacing="0" cellpadding="0"><tbody><tr><td> </td>
<td>Рабочие процессы ЦУП</td>
<td>Рабочие процессы исследуемой ИБ</td></tr><tr><td>Право чтения</td>
<td>√</td>
<td>√</td></tr><tr><td>Право записи</td>
<td>√</td>
<td>√</td></tr></tbody></table><p>ПРИМЕЧАНИЕ: В качестве локального каталога технологического журнала можно также задавать и сетевой каталог, расположенный на другом компьютере, но делать это не рекомендуется из-за соображений производительности сервера исследуемой информационной базы.</p></body></html>